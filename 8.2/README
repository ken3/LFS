
    Linux From Scratch 8.2 (x86_64) 生成手順
                                                                          作成: 2018-03-05
                                                                          更新: 2018-03-09

 1. ホストシステムにrootユーザでログインする。
   検証環境: Kali GNU/Linux 2017.1 Rolling

   $ su -

 2. 作業ディレクトリ /usr/src に GitHubリポジトリを複製する。
   # cd /usr/src
   # git clone https://github.com/ken3/LFS.git

 3. パッケージソース一式をダウンロードする。
   # cd /usr/src/LFS/8.2/packages
   # wget -i wget-list

 4. 設定をカスタマイズする。
   # cd /usr/src/LFS/8.2/scripts
   # vi buildenv

   LFS=/mnt/lfs        # マウントポイント
   ROOTDEV=/dev/sda8   # パーティション
   SWAPDEV=/dev/sda5   # スワップデバイス

 5. ホストシステムを設定する。

   # . buildenv
   # ./001_version-check.sh
   # ./002_usergroup.sh

 6. ターゲットファイルシステムを初期化する。

   # ./003_mkfs.sh
   # ./004_mount.sh
   # ./005_mkdir.sh
   # ./006_copysources.sh
   # ./007_copyscripts.sh
   # ./008_su-lfs.sh

 7. ビルドツールを生成・インストールする。

   $ cd /mnt/lfs/scripts
   $ ./stage1.sh     # 100_binutils_pass1.sh 〜 149_stripping.sh を実行
   $ ./150_logout.sh
   $ exit
   # ./190_backup.sh
   # cd /mnt/lfs/scripts
   # ./stage2.sh     # 200_ownership.sh 〜 214_varlog.sh を実行

 8. 正版モジュールを生成・インストールする。

   # ./300_chroot.sh
   # cd /scripts
   # ./stage3.sh     # 301_linuxapi.sh 〜 394_rootpass.sh を実行
   # ./395_logout.sh
   # exit
   # ./396_backup.sh
   # ./stage4.sh     # 400_chroot.sh 〜 457_release.sh を実行
   # ./490_backup.sh

 9. ターゲットシステムをブート可能にする。

   # ./500_mkinitrd.sh
   # ./501_copykernel.sh
   # ./502_umount-lfs.sh
   # ./503_backup-lfs.sh
   # ./504_umount.sh
   # ./505_updategrub.sh

10. ホストシステムを再起動する。
   # shutdown -r 0



 付録1. ホストシステムのS/Wバージョン一覧
   # ./001_version-check.sh

   /tmp /usr/src/LFS/8.2/scripts
   bash, version 4.4.12(1)-release
   /bin/sh -> /bin/bash
   Binutils: (GNU Binutils for Debian) 2.29
   bison (GNU Bison) 3.0.4
   /usr/bin/yacc -> /usr/bin/bison.yacc
   bzip2,  Version 1.0.6, 6-Sept-2010.
   Coreutils:  8.26
   diff (GNU diffutils) 3.6
   find (GNU findutils) 4.7.0-git
   GNU Awk 4.1.4, API: 1.1 (GNU MPFR 3.1.6, GNU MP 6.1.2)
   /usr/bin/awk -> /usr/bin/gawk
   gcc (Debian 7.2.0-4) 7.2.0
   g++ (Debian 7.2.0-4) 7.2.0
   (Debian GLIBC 2.24-17) 2.24
   grep (GNU grep) 3.1
   gzip 1.6
   Linux version 4.14.0-kali3-amd64 (devel@kali.org) (gcc version 7.3.0 (Debian 7.3.0-3)) #1 SMP Debian 4.14.17-1kali1 (2018-02-16)
   m4 (GNU M4) 1.4.18
   GNU Make 4.1
   GNU patch 2.7.5
   Perl version='5.26.0';
   sed (GNU sed) 4.4
   tar (GNU tar) 1.29
   texi2any (GNU texinfo) 6.5
   xz (XZ Utils) 5.2.2
   g++ compilation OK

 付録2. スクリプト一覧

   root@KALI:/usr/src/LFS/8.2/scripts# ls

001_version-check.sh   190_stripping.sh    302_gdbm.sh         362_vim.sh
002_usergroup.sh       199_logout.sh       303_gperf.sh        390_kernel.sh
003_mkfs.sh            200_ownership.sh    304_expat.sh        391_kernel-install.sh
004_mount.sh           201_kernelfs.sh     305_inetutils.sh    392_bootscripts.sh
005_mkdir.sh           202_mount-lfs.sh    306_perl.sh         393_savelib.sh
006_copysources.sh     210_chroot.sh       310_xmlparser.sh    398_rootpass.sh
007_copyscripts.sh     211_directories.sh  311_intltool.sh     399_logout.sh
008_su-lfs.sh          212_essential.sh    312_autoconf.sh     400_chroot.sh
100_binutils_pass1.sh  213_fixlink.sh      313_automake.sh     401_stripping.sh
101_gcc_pass1.sh       214_varlog.sh       314_xz.sh           450_chroot.sh
102_linuxapi.sh        250_chroot.sh       315_kmod.sh         451_cleanup.sh
103_glibc.sh           251_linuxapi.sh     316_gettext.sh      452_zaptools.sh
104_glibc-test.sh      252_man-pages.sh    320_libelf.sh       453_networking.sh
105_libstdc++.sh       253_glibc.sh        321_libffi.sh       454_sysvinit.sh
106_binutils_pass2.sh  254_toolchain.sh    322_openssl.sh      455_config.sh
107_binutils_ldnew.sh  255_zlib.sh         323_python3.sh      456_rc.sh
111_gcc_pass2.sh       256_file.sh         324_python3-doc.sh  457_release.sh
112_cc-test.sh         260_readline.sh     325_ninja.sh        500_mkinitrd.sh
113_tcl-core.sh        261_m4.sh           326_meson.sh        501_copykernel.sh
114_expect.sh          262_bc.sh           330_procps-ng.sh    502_umount-lfs.sh
115_dejagnu.sh         263_binutils.sh     331_e2fsprogs.sh    503_backup-lfs.sh
116_m4.sh              264_gmp.sh          332_coreutils.sh    504_umount.sh
120_ncurses.sh         265_mpfr.sh         333_check.sh        505_updategrub.sh
121_bash.sh            266_mpc.sh          334_diffutils.sh    backup-lfs.sh
122_bison.sh           270_gcc.sh          335_gawk.sh         bash_profile
123_bzip2.sh           271_gcc-test.sh     336_findutils.sh    bashrc
124_coreutils.sh       272_bzip2.sh        340_groff.sh        buildenv
125_diffutils.sh       273_pkg-config.sh   341_grub2.sh        buildlfs
126_file.sh            274_ncurses.sh      342_less.sh         buildtools
130_findutils.sh       275_attr.sh         343_gzip.sh         copyscripts.sh
131_gawk.sh            276_acl.sh          344_iproute2.sh     copysources.sh
132_gettext.sh         280_libcap.sh       345_kbd.sh          dispatch.sh
133_grep.sh            281_sed.sh          346_libpipeline.sh  mount-lfs.sh
134_gzip.sh            282_shadow.sh       350_make.sh         mount.sh
135_make.sh            283_psmisc.sh       351_patch.sh        stage1.sh
136_patch.sh           284_iana-etc.sh     352_sysklogd.sh     stage2.sh
140_perl.sh            285_bison.sh        353_sysvinit.sh     stage3.sh
141_sed.sh             286_flex.sh         354_eudev.sh        stage4.sh
142_tar.sh             290_grep.sh         355_util-linux.sh   umount-lfs.sh
143_texinfo.sh         291_bash.sh         356_man-db.sh       umount.sh
144_util-linux.sh      300_execbash.sh     360_tar.sh
145_xz.sh              301_libtool.sh      361_texinfo.sh

 付録3. Dockerイメージ生成手順

   # cat lfs-snapshot-8.2.tar.gz|docker import - lfs/8.2:latest
   # docker images

                                                                                      以上

